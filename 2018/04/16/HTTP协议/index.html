<!DOCTYPE html>
<html>
<head>
    
<!-- Google Analytics -->
<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'true', 'auto');
ga('send', 'pageview');
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
<!-- End Google Analytics -->


    

    



    <meta charset="utf-8">
    
    <meta name="google-site-verification" content="true">
    
    
    
    <title>HTTP协议复习 | EdwardZhang&#39;s Blog | Life starts at the end of your comfort zone. ⚽ 🏂 🏃 🚴 ⌨️</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="Network">
    <meta name="description" content="奇迹般的腾讯笔试通过了，昨天下午经过了一面…发现之前着眼于Android与Java的知识而没有对计算机网络系统的复习…导致了这次面试的滑铁卢…所以想进这样的一线大厂做一名合格的程序员还是要全面发展…不能顾此失彼  Http协议  默认端口：80  Http协议的主要特点  支持客户／服务器模式 简单快速：客户向服务端请求服务时，只需传送请求方式和路径。 灵活：允许传输任意类型的数据对象。由Con">
<meta name="keywords" content="Network">
<meta property="og:type" content="article">
<meta property="og:title" content="HTTP协议复习">
<meta property="og:url" content="https://edward7zhang.github.io/2018/04/16/HTTP协议/index.html">
<meta property="og:site_name" content="EdwardZhang&#39;s Blog">
<meta property="og:description" content="奇迹般的腾讯笔试通过了，昨天下午经过了一面…发现之前着眼于Android与Java的知识而没有对计算机网络系统的复习…导致了这次面试的滑铁卢…所以想进这样的一线大厂做一名合格的程序员还是要全面发展…不能顾此失彼  Http协议  默认端口：80  Http协议的主要特点  支持客户／服务器模式 简单快速：客户向服务端请求服务时，只需传送请求方式和路径。 灵活：允许传输任意类型的数据对象。由Con">
<meta property="og:image" content="http://hi.csdn.net/attachment/201108/7/0_131271823564Rx.gif">
<meta property="og:image" content="https://img-blog.csdn.net/20170104214009596?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2h1c2xlaQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center">
<meta property="og:image" content="http://hi.csdn.net/attachment/201108/7/0_1312718564tZXD.gif">
<meta property="og:image" content="http://hi.csdn.net/attachment/201108/7/0_1312719804oSkK.gif">
<meta property="og:image" content="http://hi.csdn.net/attachment/201108/7/0_1312719833030b.gif">
<meta property="og:updated_time" content="2018-04-16T13:58:56.825Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="HTTP协议复习">
<meta name="twitter:description" content="奇迹般的腾讯笔试通过了，昨天下午经过了一面…发现之前着眼于Android与Java的知识而没有对计算机网络系统的复习…导致了这次面试的滑铁卢…所以想进这样的一线大厂做一名合格的程序员还是要全面发展…不能顾此失彼  Http协议  默认端口：80  Http协议的主要特点  支持客户／服务器模式 简单快速：客户向服务端请求服务时，只需传送请求方式和路径。 灵活：允许传输任意类型的数据对象。由Con">
<meta name="twitter:image" content="http://hi.csdn.net/attachment/201108/7/0_131271823564Rx.gif">
    
        <link rel="alternate" type="application/atom+xml" title="EdwardZhang&#39;s Blog" href="/atom.xml">
    
    <link rel="shortcut icon" href="/img/favicon.png">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

</head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">EdwardZhang</h5>
          <a href="mailto:super7edwardzhang@gmail.com" title="super7edwardzhang@gmail.com" class="mail">super7edwardzhang@gmail.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                Homepage
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/photo"  >
                <i class="icon icon-lg icon-photo"></i>
                Album
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/Edward7Zhang" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://weibo.com/u/3100298257/home?wvr=5" target="_blank" >
                <i class="icon icon-lg icon-weibo"></i>
                Weibo
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://www.instagram.com/major7edward/" target="_blank" >
                <i class="icon icon-lg icon-instagram"></i>
                Instagram
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/link"  >
                <i class="icon icon-lg icon-link"></i>
                Friends&#39; Link
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">HTTP协议复习</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="Search">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">HTTP协议复习</h1>
        <h5 class="subtitle">
            
                <time datetime="2018-04-16T02:43:13.000Z" itemprop="datePublished" class="page-time">
  2018-04-16
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Http协议"><span class="post-toc-number">1.</span> <span class="post-toc-text">Http协议</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Http协议的主要特点"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">Http协议的主要特点</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#非持续性和持续性"><span class="post-toc-number">1.1.1.</span> <span class="post-toc-text">非持续性和持续性</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#持续性"><span class="post-toc-number">1.1.1.1.</span> <span class="post-toc-text">持续性</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#非持续性"><span class="post-toc-number">1.1.1.2.</span> <span class="post-toc-text">非持续性</span></a></li></ol></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#非流水线和流水线"><span class="post-toc-number">1.1.2.</span> <span class="post-toc-text">非流水线和流水线</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#POST和GET的区别"><span class="post-toc-number">1.1.2.1.</span> <span class="post-toc-text">POST和GET的区别</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#为什么POST效率低，Get效率高"><span class="post-toc-number">1.1.2.2.</span> <span class="post-toc-text">为什么POST效率低，Get效率高</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Https"><span class="post-toc-number">1.2.</span> <span class="post-toc-text">Https</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Socket"><span class="post-toc-number">2.</span> <span class="post-toc-text">Socket</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#使用TCP"><span class="post-toc-number">2.0.1.</span> <span class="post-toc-text">使用TCP</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#使用UDP"><span class="post-toc-number">2.1.</span> <span class="post-toc-text">使用UDP</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#TCP与UDP"><span class="post-toc-number">3.</span> <span class="post-toc-text">TCP与UDP</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#TCP协议"><span class="post-toc-number">3.1.</span> <span class="post-toc-text">TCP协议</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#三次握手的过程："><span class="post-toc-number">3.1.1.</span> <span class="post-toc-text">三次握手的过程：</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#四次挥手过程"><span class="post-toc-number">3.1.2.</span> <span class="post-toc-text">四次挥手过程</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#UDP协议"><span class="post-toc-number">3.2.</span> <span class="post-toc-text">UDP协议</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#TCP与UDP的区别"><span class="post-toc-number">3.3.</span> <span class="post-toc-text">TCP与UDP的区别</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#问题"><span class="post-toc-number">4.</span> <span class="post-toc-text">问题</span></a></li></ol>
        </nav>
    </aside>


<article id="post-HTTP协议"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">HTTP协议复习</h1>
        <div class="post-meta">
            <time class="post-time" title="2018-04-16 10:43:13" datetime="2018-04-16T02:43:13.000Z"  itemprop="datePublished">2018-04-16</time>

            


            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <blockquote>
<p>奇迹般的腾讯笔试通过了，昨天下午经过了一面…发现之前着眼于Android与Java的知识而没有对计算机网络系统的复习…导致了这次面试的滑铁卢…所以想进这样的一线大厂做一名合格的程序员还是要全面发展…不能顾此失彼</p>
</blockquote>
<h1 id="Http协议"><a href="#Http协议" class="headerlink" title="Http协议"></a>Http协议</h1><hr>
<ul>
<li>默认端口：80</li>
</ul>
<h2 id="Http协议的主要特点"><a href="#Http协议的主要特点" class="headerlink" title="Http协议的主要特点"></a>Http协议的主要特点</h2><hr>
<ol>
<li>支持客户／服务器模式</li>
<li>简单快速：客户向服务端请求服务时，只需传送请求方式和路径。</li>
<li>灵活：允许传输任意类型的数据对象。由Content-Type加以标记。</li>
<li>无连接：每次响应一个请求，响应完成以后就断开连接。</li>
<li>无状态：服务器不保存浏览器的任何信息。每次提交的请求之间没有关联。</li>
</ol>
<h3 id="非持续性和持续性"><a href="#非持续性和持续性" class="headerlink" title="非持续性和持续性"></a>非持续性和持续性</h3><hr>
<ul>
<li>HTTP1.0默认非持续性；HTTP1.1默认持续性</li>
</ul>
<h4 id="持续性"><a href="#持续性" class="headerlink" title="持续性"></a>持续性</h4><p>浏览器和服务器建立TCP连接后，可以请求多个对象</p>
<h4 id="非持续性"><a href="#非持续性" class="headerlink" title="非持续性"></a>非持续性</h4><p>浏览器和服务器建立TCP连接后，只能请求一个对象</p>
<h3 id="非流水线和流水线"><a href="#非流水线和流水线" class="headerlink" title="非流水线和流水线"></a>非流水线和流水线</h3><hr>
<p>类似于组成里面的流水操作</p>
<ul>
<li>流水线：不必等到收到服务器的回应就发送下一个报文。</li>
<li>非流水线：发出一个报文，等到响应，再发下一个报文。类似TCP。</li>
</ul>
<h4 id="POST和GET的区别"><a href="#POST和GET的区别" class="headerlink" title="POST和GET的区别"></a>POST和GET的区别</h4><table>
<thead>
<tr>
<th>Post一般用于更新或者添加资源信息</th>
<th style="text-align:center">Get一般用于查询操作，而且应该是安全和幂等的</th>
</tr>
</thead>
<tbody>
<tr>
<td>Post更加安全</td>
<td style="text-align:center">Get会把请求的信息放到URL的后面</td>
</tr>
<tr>
<td>Post传输量一般无大小限制</td>
<td style="text-align:center">Get不能大于2KB</td>
</tr>
<tr>
<td>Post执行效率低</td>
<td style="text-align:center">Get执行效率略高</td>
</tr>
</tbody>
</table>
<h4 id="为什么POST效率低，Get效率高"><a href="#为什么POST效率低，Get效率高" class="headerlink" title="为什么POST效率低，Get效率高"></a>为什么POST效率低，Get效率高</h4><hr>
<ul>
<li>Get将参数拼成URL,放到header消息头里传递</li>
<li>Post直接以键值对的形式放到消息体中传递。</li>
<li>但两者的效率差距很小很小</li>
</ul>
<h2 id="Https"><a href="#Https" class="headerlink" title="Https"></a>Https</h2><hr>
<ul>
<li>端口号是443</li>
<li>是由SSL+Http协议构建的可进行加密传输、身份认证的网络协议。</li>
</ul>
<h1 id="Socket"><a href="#Socket" class="headerlink" title="Socket"></a>Socket</h1><hr>
<h3 id="使用TCP"><a href="#使用TCP" class="headerlink" title="使用TCP"></a>使用TCP</h3><hr>
<p>客户端</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Socket socket = new Socket(&quot;ip&quot;, 端口);</div><div class="line"></div><div class="line">InputStream is = socket.getInputStream();</div><div class="line">DataInputStream dis = new DataInputStream(is);</div><div class="line"></div><div class="line">OutputStream os = socket.getOutputStream();</div><div class="line">DataInputStream dos = new DataOutputStream(os);</div></pre></td></tr></table></figure>
<p>服务器端</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ServerSocket serverSocket = new ServerSocket(端口);</div><div class="line">Socket socket = serverSocket.accept();</div><div class="line">//获取流的方式与客户端一样</div></pre></td></tr></table></figure>
<p>读取输入流</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">byte[] buffer = new byte[1024]; </div><div class="line">do&#123; </div><div class="line">	int count = is.read(buffer); </div><div class="line">	if(count &lt;= 0)&#123; break; &#125;</div><div class="line">	else&#123; </div><div class="line">	// 对buffer保存或者做些其他操作 </div><div class="line">		&#125; </div><div class="line">	&#125;</div><div class="line">while(true);</div></pre></td></tr></table></figure>
<h2 id="使用UDP"><a href="#使用UDP" class="headerlink" title="使用UDP"></a>使用UDP</h2><p>客户端和服务器端一样的</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">DatagramSocket socket = new DatagramSocket(端口);</div><div class="line">InetAddress serverAddress = InetAddress.getbyName(&quot;ip&quot;);</div><div class="line">//发送</div><div class="line">DatagramPackage packet = new DatagramPacket(buffer, length, host, port);</div><div class="line">socket.send(packet);</div><div class="line">//接收</div><div class="line">byte[] buf = new byte[1024];</div><div class="line">DatagramPacket packet = new DatagramPacket(buf, 1024);</div><div class="line">Socket.receive(packet);</div></pre></td></tr></table></figure>
<h1 id="TCP与UDP"><a href="#TCP与UDP" class="headerlink" title="TCP与UDP"></a>TCP与UDP</h1><hr>
<p><strong>面向报文的传输方式</strong>是应用层交给UDP多长的报文，UDP就照样发送，即一次发送一个报文。因此，应用程序必须选择合适大小的报文。若报文太长，则IP层需要分片，降低效率。若太短，会是IP太小。UDP对应用层交下来的报文，既不合并，也不拆分，而是保留这些报文的边界。这也就是说，应用层交给UDP多长的报文，UDP就照样发送，即一次发送一个报文。<br><strong>面向字节流</strong>的话，虽然应用程序和TCP的交互是一次一个数据块（大小不等），但TCP把应用程序看成是一连串的无结构的字节流。TCP有一个缓冲，当应用程序传送的数据块太长，TCP就可以把它划分短一些再传送。如果应用程序一次只发送一个字节，TCP也可以等待积累有足够多的字节后再构成报文段发送出去。</p>
<h2 id="TCP协议"><a href="#TCP协议" class="headerlink" title="TCP协议"></a>TCP协议</h2><hr>
<hr>
<ul>
<li>Transmission Control Protocol，传输控制协议</li>
<li>面向连接的协议</li>
<li>需要三次握手建立连接</li>
<li>需要四次挥手断开连接</li>
<li>TCP报头最小长度：20字节<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://hi.csdn.net/attachment/201108/7/0_131271823564Rx.gif" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
</li>
</ul>
<h3 id="三次握手的过程："><a href="#三次握手的过程：" class="headerlink" title="三次握手的过程："></a>三次握手的过程：</h3><hr>
<hr>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://img-blog.csdn.net/20170104214009596?watermark/2/text/aHR0cDovL2Jsb2cuY3Nkbi5uZXQvd2h1c2xlaQ==/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70/gravity/Center" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<ol>
<li>客户端发送：SYN = 1, SEQ = X, 端口号</li>
<li>服务器回复：SYN = 1, ack = X + 1, SEQ = Y，ACK = 1</li>
<li>客户端发送：ack = Y + 1, SEQ = X + 1,ACK = 1</li>
</ol>
<ul>
<li>SYN – 建立连接位</li>
<li>ACK – 响应位</li>
<li>SEQ – 顺序号码</li>
<li><p>ack – 确认号</p>
<blockquote>
<p>确认应答信号ACK = 收到的SEQ + 1。<br>连接建立中，同步信号SYN始终为1。连接建立后，同步信号SYN=0。</p>
</blockquote>
</li>
<li><p>第一次握手：主机A发送位码为SYN = 1，随机产生SEQ = 1234567的数据包到服务器，主机B由SYN = 1知道，A要建立联机</p>
</li>
<li>第二次握手：主机B收到请求后要确认联机信息，向A发送ACK = （主机A的SEQ+1），SYN = 1，ack = 1，随机产生SEQ = 3452671的包；</li>
<li>第三次握手：主机A收到后检查ack是否正确，即第一次发送的（SEQ+1），以及位码ACK是否为1，若正确，主机A会再发送ack = （主机B的SEQ+1），ACK = 1，主机B收到后确认SEQ值与ACK = 1则连接建立成功。</li>
</ul>
<h3 id="四次挥手过程"><a href="#四次挥手过程" class="headerlink" title="四次挥手过程"></a>四次挥手过程</h3><hr>
<hr>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://hi.csdn.net/attachment/201108/7/0_1312718564tZXD.gif" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<ol>
<li>A向B提出停止连接请求，FIN = 1</li>
<li>B收到，ACK = 1</li>
<li>B向A提出停止连接请求，FIN = 1</li>
<li>A收到，ACK = 1</li>
</ol>
<ul>
<li>FIN – 关闭连接</li>
<li>SYN – 建立连接位</li>
<li>ACK – 响应位</li>
<li>SEQ – 顺序号码</li>
<li>ack – 确认号<br><strong>优点：</strong> </li>
</ul>
<hr>
<ul>
<li>可靠，稳定<pre><code>1、传递数据前，会有三次握手建立连接
2、传递数据时，有确认、窗口、重传、拥塞控制
3、传递数据后，会断开连接节省系统资源
</code></pre></li>
</ul>
<p><strong>缺点：</strong></p>
<hr>
<ul>
<li><p>传输慢，效率低，占用系统资源高<br>1、传递数据前，建立连接需要耗时<br>2、传递数据时，确认、重传、拥塞等会消耗大量时间以及CPU和内存等硬件资源</p>
</li>
<li><p>易被攻击<br>1、因为有确认机制，三次握手等机制，容易被人利用，实现DOS 、DDOS攻击</p>
</li>
</ul>
<p><strong>如何保证接收的顺序性：</strong></p>
<hr>
<p>TCP协议使用SEQ和ACK机制保证了顺序性<br>TCP的每个报文都是有序号的。确认应答信号ACK=收到的SEQ+1</p>
<p><strong>【注意】中断连接端可以是Client端，也可以是Server端。</strong></p>
<p>假设Client端发起中断连接请求，也就是发送FIN报文。Server端接到FIN报文后，意思是说”我Client端没有数据要发给你了”，但是如果你还有数据没有发送完成，则不必急着关闭Socket，可以继续发送数据。所以你先发送ACK，”告诉Client端，你的请求我收到了，但是我还没准备好，请继续你等我的消息”。这个时候Client端就进入FIN_WAIT状态，继续等待Server端的FIN报文。当Server端确定数据已发送完成，则向Client端发送FIN报文，”告诉Client端，好了，我这边数据发完了，准备好关闭连接了”。Client端收到FIN报文后，”就知道可以关闭连接了，但是他还是不相信网络，怕Server端不知道要关闭，所以发送ACK后进入TIME_WAIT状态，如果Server端没有收到ACK则可以重传。“，Server端收到ACK后，”就知道可以断开连接了”。Client端等待了2MSL后依然没有收到回复，则证明Server端已正常关闭，那好，我Client端也可以关闭连接了。Ok，TCP连接就这样关闭了！</p>
<p>整个过程Client端所经历的状态如下：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://hi.csdn.net/attachment/201108/7/0_1312719804oSkK.gif" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure> 
<p>而Server端所经历的过程如下：</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://hi.csdn.net/attachment/201108/7/0_1312719833030b.gif" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure> 
<p><strong>【注意】</strong> 在TIME_WAIT状态中，如果TCP client端最后一次发送的ACK丢失了，它将重新发送。TIME_WAIT状态中所需要的时间是依赖于实现方法的。典型的值为30秒、1分钟和2分钟。等待之后连接正式关闭，并且所有的资源(包括端口号)都被释放。</p>
<h2 id="UDP协议"><a href="#UDP协议" class="headerlink" title="UDP协议"></a>UDP协议</h2><hr>
<hr>
<ul>
<li>User Data Protocol，用户数据包协议</li>
<li>面向无连接的协议</li>
<li>UDP报头只有8字节</li>
</ul>
<p><strong>简介：</strong></p>
<hr>
<ul>
<li>传输数据之前源端和终端不建立连接，当它想传送时就简单地去抓取来自应用程序的数据，并尽可能快的把它扔到网络上</li>
<li>在发送端，UDP传送数据的速度仅仅是受应用程序生成数据的速度、计算机的能力和传输带宽的限制</li>
<li>在接收端，UDP把每个消息段放在队列中，应用程序每次从队列中读一个消息段</li>
<li>由于传输数据不建立连接，因此也就不需要维护连接状态，包括收发状态等，因此一台服务机可同时向多个客户机传输相同的消息</li>
<li>UDP信息包的标题很短，只有8个字节，相对于TCP的20个字节信息包的额外开销很小</li>
<li>吞吐量不受拥挤控制算法的调节，只受应用软件生成数据的速率、传输带宽、源端和终端主机性能的限制</li>
<li>UDP使用尽最大努力交付，即不保证可靠交付，因此主机不需要维持复杂的链接状态表。</li>
<li>UDP是面向报文的。发送方的UDP对应用程序交下来的报文，在添加首部后就向下交付给IP层。既不拆分，也不合并，而是保留这些报文的边界，因此，应用程序需要选择合适的报文大小。</li>
</ul>
<blockquote>
<p>使用“ping”命令来测试两台主机之间TCP/IP通信是否正常，其实“ping”命令的原理就是向对方主机发送UDP数据包，然后对方主机确认收到数据包，如果数据包是否到达的消息及时反馈回来，那么网络就是通的。</p>
</blockquote>
<p><strong>优点：</strong></p>
<hr>
<ul>
<li><p>传输速率快<br>1、传输数据前，不需要像TCP一样建立连接<br>2、传输数据时，没有确认、窗口、重传、拥塞控制等机制</p>
</li>
<li><p>较安全<br>1、由于没有了TCP的一些机制，被攻击者利用的漏洞就少了</p>
</li>
</ul>
<p><strong>缺点：</strong></p>
<hr>
<ul>
<li>不可靠，不稳定<br>1、由于没有了TCP的机制，在数据传输时如果网络不好，很可能丢包</li>
</ul>
<p><strong>用UDP协议通讯时怎样得知目标机是否获得了数据包</strong></p>
<hr>
<p>仿造TCP的做法，每发一个UDP包，都在里面加一个SEQ序号，接收方收到包后，将SEQ序号回复给发送方。如果发送方在指定时间以内没有收到回应，说明丢包了。</p>
<h2 id="TCP与UDP的区别"><a href="#TCP与UDP的区别" class="headerlink" title="TCP与UDP的区别"></a>TCP与UDP的区别</h2><hr>
<table class="table table-bordered table-striped table-condensed"><br>    <tr><br>        <td>TCP面向<strong>有链接</strong>的通信服务</td><br>        <td>UDP面向<strong>无连接</strong>的通信服务</td><br>    </tr><br>    <tr><br>        <td>TCP提供可靠的通信传输</td><br>        <td>UDP不可靠,会丢包</td><br>    </tr><br>    <tr><br>        <td>TCP保证数据顺序</td><br>        <td>UDP不保证</td><br>    </tr><br>    <tr><br>        <td>TCP数据无边界</td><br>        <td>UDP有边界</td><br>    </tr><br>    <tr><br>        <td>TCP速度快</td><br>        <td>UDP速度慢</td><br>    </tr><br>    <tr><br>        <td>TCP面向字节流</td><br>        <td>UDP面向报文</td><br>    </tr><br>    <tr><br>        <td>TCP一对一</td><br>        <td>UDP可以一对一，一对多</td><br>    </tr><br>    <tr><br>        <td>TCP报头至少20字节</td><br>        <td>UDP报头8字节</td><br>    </tr><br>    <tr><br>        <td>TCP有流量控制，拥塞控制</td><br>        <td>UDP没有</td><br>    </tr><br></table>

<h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><p><strong>为什么UDP比TCP快</strong></p>
<hr>
<ol>
<li>TCP需要三次握手</li>
<li>TCP有拥塞控制，控制流量等机制</li>
</ol>
<p><strong>为什么TCP比UDP可靠</strong></p>
<hr>
<ol>
<li>TCP是面向有连接的，建立连接之后才发送数据；而UDP则不管对方存不存在都会发送数据。</li>
<li>TCP有确认机制，接收端每收到一个正确包都会回应给发送端。超时或者数据包不完整的话发送端会重传。UDP没有。因此可能丢包。</li>
</ol>
<p><strong>什么时候使用TCP</strong></p>
<hr>
<p>当对网络通讯质量有要求的时候，比如：整个数据要准确无误的传递给对方，这往往用于一些要求可靠的应用，比如HTTP、HTTPS、FTP等传输文件的协议，POP、SMTP等邮件传输的协议。<br>在日常生活中，常见使用TCP协议的应用如下：<br>浏览器，用的HTTP<br>FlashFXP，用的FTP<br>Outlook，用的POP、SMTP<br>Putty，用的Telnet、SSH<br>QQ文件传输</p>
<p><strong>什么时候应该使用UDP：</strong></p>
<hr>
<p>当对网络通讯质量要求不高的时候，要求网络通讯速度能尽量的快，这时就可以使用UDP。<br>比如，日常生活中，常见使用UDP协议的应用如下：<br>QQ语音<br>QQ视频<br>TFTP</p>
<p><strong>TCP无边界，UDP有边界</strong></p>
<hr>
<p><strong>TCP无边界</strong></p>
<p>客户端分多次发送数据给服务器，若服务器的缓冲区够大，那么服务器端会在客户端发送完之后一次性接收过来，所以是无边界的；</p>
<p><strong>UDP有边界</strong></p>
<p>客户端每发送一次，服务器端就会接收一次，也就是说发送多少次就会接收多少次，因此是有边界的。</p>
<p><strong>为什么连接的时候是三次握手，关闭的时候是四次握手？</strong></p>
<hr>
<p>因为当Server端收到Client端的SYN连接请求报文后，可以直接发送SYN+ACK报文。其中ACK报文是用来应答的，SYN报文是用来同步的。但是关闭连接时，当Server端收到FIN报文时，很可能并不会立即关闭SOCKET，所以只能先回复一个ACK报文，告诉Client端，“你发的FIN报文我收到了”。只有等到我Server端所有的报文都发送完了，我才能发送FIN报文，因此不能一起发送。故需要四次握手</p>
<p><strong>为什么TIME_WAIT状态需要经过2MSL(最大报文段生存时间)才能返回到CLOSE状态？</strong></p>
<hr>
<p>虽然按道理，四个报文都发送完毕，我们可以直接进入CLOSE状态了，但是我们必须假象网络是不可靠的，有可以最后一个ACK丢失。所以TIME_WAIT状态是用来重发可能丢失的ACK报文。</p>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2018-04-16T13:58:56.825Z" itemprop="dateUpdated">2018-04-16 21:58:56</time>
</span><br>


        
        Original Link：<a href="/2018/04/16/HTTP协议/" target="_blank" rel="external">https://edward7zhang.github.io/2018/04/16/HTTP协议/</a>
        
    </div>
    
    <footer>
        <a href="https://edward7zhang.github.io">
            <img src="/img/avatar.jpg" alt="EdwardZhang">
            EdwardZhang
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Network/">Network</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://edward7zhang.github.io/2018/04/16/HTTP协议/&title=《HTTP协议复习》 — EdwardZhang's Blog&pic=https://edward7zhang.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://edward7zhang.github.io/2018/04/16/HTTP协议/&title=《HTTP协议复习》 — EdwardZhang's Blog&source=Life starts at the end of your comfort zone." data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://edward7zhang.github.io/2018/04/16/HTTP协议/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《HTTP协议复习》 — EdwardZhang's Blog&url=https://edward7zhang.github.io/2018/04/16/HTTP协议/&via=https://edward7zhang.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://edward7zhang.github.io/2018/04/16/HTTP协议/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2018/04/17/Android网络编程面试题集/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">Android网络编程面试题集</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2018/04/15/Android开源库面试题集/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Android开源库面试题集</h4>
      </a>
    </div>
  
</nav>



    


<section class="comments" id="comments">
    <div id="disqus_thread"></div>
    <script>
    var disqus_shortname = 'EdwardZhang777';
    lazyScripts.push('//' + disqus_shortname + '.disqus.com/embed.js')
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>













</article>



</div>

        <footer class="footer">
    <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>This blog is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>EdwardZhang &copy; 2016 - 2019</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://edward7zhang.github.io/2018/04/16/HTTP协议/&title=《HTTP协议复习》 — EdwardZhang's Blog&pic=https://edward7zhang.github.io/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://edward7zhang.github.io/2018/04/16/HTTP协议/&title=《HTTP协议复习》 — EdwardZhang's Blog&source=Life starts at the end of your comfort zone." data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://edward7zhang.github.io/2018/04/16/HTTP协议/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《HTTP协议复习》 — EdwardZhang's Blog&url=https://edward7zhang.github.io/2018/04/16/HTTP协议/&via=https://edward7zhang.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://edward7zhang.github.io/2018/04/16/HTTP协议/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACHElEQVR42u3a0Q4CIQxE0f3/n15fTQw4M2WNlMuT2azIwaQptNclj/ttfD7//Dx6osw2+taCAQMGjG0Z93SMljtfovtkNLOyNhgwYJzDmC9oPoWyBdlG6JsFAwYMGEoInoO/hEsYMGDAWMTQD67Kot2UFAYMGDD09C57/4/O4jBgwNiQod+6//7zI/UNGDBgbMW4o5GVB9yygbEeGDBgtGa4QdBN9fR3so2DAQPGmQz3SDlfin4BlyGNGA8DBoxtGe51vF7aXNWQYYRaGDBgNGVUErV6m8XjGBgwYLRgrLqaryeFFSoMGDDOYVQu5fVLOiX262EdBgwYJzCy4mLGVoK18tzoCoEBA0Y7RuUS331TJ+nBHQYMGF0ZWTFAP3xmjWJ2GRUGDBitGVkrWHbQXYWRekZgwIDRjqEfGt3WilWXcUYNFgYMGE0ZWYuDW3rMeMZGw4ABozWjcj/nFjVdUljChAEDRiOGGxbrzWSVwoMRZGHAgNGIoYTaVexKy0X4n8CAAaMFIysDVEqe7iFZWicMGDBaM9yU7stE8gx22qefwmHAgNGO8VzbRD2UG+UBGDBgtGbowy1YZoVPt8wJAwaMcxj15ol6M1k9EMOAAeMERtYMoYfUrCFDXxUMGDBg6ItQYG76aKSGMGDAOJ6hp4mVK7PwuzBgwDiAoQdHBeDiXcYwNYQBA0ZTRtYqofyA8pPZll3ZgAEDxn6MF/VtesCTAF6PAAAAAElFTkSuQmCC" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>



<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>

<script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" async></script>




<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = '42';
            clearTimeout(titleTime);
        } else {
            document.title = 'Don‘t Panic！';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
